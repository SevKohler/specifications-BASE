= Core Package

== Overview

The `core` package, shown below, defines the main BMM model.

[.text-center]
.RM Core Package
image::{uml_export_dir}/diagrams/BASE-bmm.core.svg[id=core_package, align="center"]

== Semantics

=== Basics

Three top-level classes define basic abstract semantics for all other entities in the BMM: `BMM_MODEL_ELEMENT`, `BMM_CLASSIFIER` and `BMM_TYPE`. The first of these introduces features common to all elements of any BMM, such as `_documentation_`. The class `BMM_CLASSIFIER` is the abstract parent of anything that functions as the type of a property (viz: classes, types and generic parameters), while its descendant `BMM_TYPE` defines the semantics of types of instances, described below.

The `BMM_CLASSIFIER` class has a small number of important features that establish formally the meaning of various kinds of class names, type names etc, as follows:

* _type_name_: the effective type of an entity; for simple classes, this will just be the class name (`BMM_CLASS._name_`); for generic and container classes it will be generic name such as `List<T>`, `Interval<T>` etc; for feature types it will be the declared type, i.e. a simple name, an open type name (e.g. `T`) or a generic type name (e.g. `Interval<Time>`);
* _type_signature_: a form of the type name that can be used as a fully-defined type signature, which for generic classes includes generic constrainer types, giving a signature such as `Interval<T:Ordered>`;
* _conformance_type_name_: a reduced form of the type useful in some circumstances that is either a simple class name, the _contained_ type for a container type (e.g. `ELEMENT` from the type `List<ELEMENT>`), and the _root_ type from a generic type (e.g. `Interval` from `Interval<T>`).

In addition, concrete classes such as `BMM_CLASS` and `BMM_PROPERTY` have a simple `_name_` property, corresponding to the literal names of these entities.

=== Classes and Types

One of the foundational concepts in the BMM is a distinction between _class_ and _type_, in common with the type systems of the modern forms of most object-oriented languages. Classes are definitional entities, while 'type' has two meanings: as the static (design time) type of a class feature (property or function result) and as the dynamic (run-time) type of the object referred to by or computed by that feature. At design time, the type of a property in a BMM model can be one of the following:

* a `BMM_SIMPLE_TYPE` - corresponds to a simple class;
* a `BMM_OPEN_TYPE` - corresponds to a generic parameter type from the class type definition, e.g. `T`, `U` etc;
* a `BMM_GENERIC_TYPE` - a type generated by the use of a generic type with filled type parameters, e.g. `Interval<Time>`;
* a `BMM_CONTAINER_TYPE` - a type generated by the use of a linear container type such as `List<T>`, `Hash<T,U>` with actual generic parameters.

In object-oriented type theory, the last two are really the same thing, but the BMM treats them slightly differently for reasons of clarity: a `BMM_CONTAINER_TYPE` can be thought of as a 1:N counterpart to a `BMM_SIMPLE_TYPE`, whereas `BMM_GENERIC_TYPE` is typically used for objects considered to be singular, but whose types are a product of a special container and one or more parameter types.

=== Inheritance

The BMM supports single and multiple inheritance, although it does not distinguish between different types of inheritance relation as some programming languages do. The evaluation of inheritance relations defined in a BMM schema results in an acyclic graph such that ancestors and descendants can be visualised for any class. The following screen shot shows the ancestors view of a class `OBSERVATION`.

[.text-center]
.BMM class - ancestors view
image::images/awb_class_ancestors.png[id=awb_class_ancestors, align="center", width="40%"]

The next screenshot shows the descendants view of one of the ancestorsclasses of the same class.

[.text-center]
.BMM class - descendants view
image::images/awb_class_descendants.png[id=awb_class_descendants, align="center", width="40%"]

Multiple inheritance is typically used in the definition of classes that have a Liskov substitution inheritance relation as well as an implementation inheritance relation. The following shows a class `DV_INTERVAL<T>` multiply inheriting from `Interval<T>` and `DATA_VALUE`.

[.text-center]
.BMM class - descendants view
image::images/awb_multiple_inheritance.png[id=awb_class_descendants, align="center", width="40%"]

=== Classes and Properties

Class properties are defined using the generic class `BMM_PROPERTY <T: BMM_TYPE>`. This approach provides a direct way of expressing the semantics of property meta-types as listed above. The properties of a class can be understood in two forms. In an original model definition, each class definition states the features it introduces with respect to its inheritance parents. We can think of this list of properties as a _differential_ set. In contrast, the _effective_ set of properties for a class is the result of evaluating these lists of properties down the inheritance hierarchy to obtain the _flat_ set of properties. The features _properties_ and _flat_properties_ defined on `BMM_CLASS` provide access to these two lists for any class.

== Class Definitions

include::{uml_export_dir}/classes/bmm_definitions.adoc[]
include::{uml_export_dir}/classes/bmm_model_element.adoc[]
include::{uml_export_dir}/classes/bmm_schema_core.adoc[]
include::{uml_export_dir}/classes/bmm_model.adoc[]
include::{uml_export_dir}/classes/bmm_package_container.adoc[]
include::{uml_export_dir}/classes/bmm_package.adoc[]
include::{uml_export_dir}/classes/bmm_classifier.adoc[]
include::{uml_export_dir}/classes/bmm_type_element.adoc[]
include::{uml_export_dir}/classes/bmm_type.adoc[]
include::{uml_export_dir}/classes/bmm_class.adoc[]
include::{uml_export_dir}/classes/bmm_property.adoc[]
include::{uml_export_dir}/classes/bmm_container_property.adoc[]
include::{uml_export_dir}/classes/bmm_simple_type.adoc[]
include::{uml_export_dir}/classes/bmm_open_type.adoc[]
include::{uml_export_dir}/classes/bmm_container_type.adoc[]
include::{uml_export_dir}/classes/bmm_generic_type.adoc[]
include::{uml_export_dir}/classes/bmm_generic_parameter.adoc[]
include::{uml_export_dir}/classes/bmm_generic_class.adoc[]
include::{uml_export_dir}/classes/bmm_enumeration.adoc[]
include::{uml_export_dir}/classes/bmm_enumeration_string.adoc[]
include::{uml_export_dir}/classes/bmm_enumeration_integer.adoc[]

